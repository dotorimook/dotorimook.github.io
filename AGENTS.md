# AGENTS.md - Developer & Agent Guide

This file provides context and instructions for AI agents and developers working on this repository.

## 1. Project Overview
- **Type**: Gatsby Static Site (Blog)
- **Language**: TypeScript (v3.x)
- **Framework**: React (v16.8+) + Gatsby (v2)
- **Styling**: Styled Components
- **State/Data**: GraphQL with Apollo codegen
- **Deployment**: Source code lives in `gatsby` branch. Build artifacts are deployed to `master` branch via `gh-pages`.

## 2. Key Commands
| Command | Description |
|---------|-------------|
| `npm start` / `npm run develop` | Start local development server (localhost:8000) |
| `npm run build` | Build the production site to `public/` |
| `npm run deploy` | Build and deploy to GitHub Pages (`master` branch) |
| `npm run lint` | Run TSLint |
| `npm run format` | Format code with Prettier |
| `npm run gql-codegen` | Generate TypeScript types for GraphQL queries |
| `npm run tsc` | Check TypeScript types (no emit) |

## 3. Code Style & Conventions

### TypeScript
- **Strictness**: Moderate.
- **Generated Types**: GraphQL types (via `graphql-codegen`) often return nullable fields.
  - *Pattern*: You may need to use optional chaining (`?.`) or non-null assertions (`!`) if you are certain data exists.
  - *Goal*: Improve type safety where possible, but acknowledge the limitations of the current codegen setup.
- **Interfaces**: Do NOT prefix interfaces with `I` (e.g., `Props`, not `IProps`).

### Styling
- **Library**: `styled-components`
- **Pattern**: Avoid inline styles. Define styled components at the bottom of the file or in a separate file if complex.
- **Global Styles**: Managed via `src/utils/typography.ts` and global CSS imports.

### Component Structure
- **Functional Components**: Use `React.FC<Props>` or `function Component({ prop }: Props)`.
- **Hooks**: Use React Hooks (`useState`, `useEffect`) over class components.
- **Location**:
  - `src/pages/`: Route components (Gatsby pages).
  - `src/templates/`: Blog post layouts (generated via `gatsby-node.js`).
  - `src/components/`: Reusable UI components.

### Formatting & Linting
- **Tool**: TSLint + Prettier (Note: TSLint is deprecated but used here).
- **Rule**: Run `npm run lint` to check for issues.
- **Config**: See `tslint.json` and `.prettierrc` (if present, otherwise default).

## 4. Testing
- **Status**: No unit tests currently configured (`npm test` is a placeholder).
- **Future**: If adding tests, use Jest + React Testing Library.

## 5. Deployment Workflow
- **Source Branch**: `gatsby` (Work here!)
- **Public Branch**: `master` (Do not edit directly. Generated by `npm run deploy`)
- **Agent Instruction**: ALWAYS ensure you are on the `gatsby` branch before making code changes.

## 6. Project Structure
```
.
├── content/
│   ├── blog/          # Markdown blog posts
│   └── assets/        # Static assets (images)
├── src/
│   ├── components/    # Reusable components (Layout, Bio, etc.)
│   ├── pages/         # Page routes (index, 404)
│   ├── templates/     # Post templates
│   ├── utils/         # Helpers (typography)
│   ├── interfaces/    # Shared TS interfaces
│   └── lib/           # Library code
├── gatsby-config.js   # Plugin configuration
├── gatsby-node.js     # Node APIs (page generation)
└── package.json       # Dependencies and scripts
```

## 7. Working with Legacy Dependencies
- This project uses older versions of Gatsby and TypeScript.
- Avoid upgrading packages unless explicitly requested, as breaking changes are likely.
- If you encounter type errors with `graphql-codegen` generated types, verify the `codegen.yml` configuration.
